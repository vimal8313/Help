ReadSpeaker.ui=function(){var b=null,g=[],p=[],x=!1,t=function(f){f=f||window.event;f.returnValue=!1;if(f=f.originalEvent)f.cancelBubble=!0,f.returnValue=!1;f&&f.preventDefault&&f.preventDefault();f&&f.stopPropagation&&f.stopPropagation()},k=function(){rspkr.log("[rspkr.ui] Attempting to add click events.");var f=$rs.get("."+rspkr.ui.rsbtnClass+" a.rsbtn_play"),b=null;$rs.isArray(f)||(f=[f]);for(var a=0,e=f.length;a<e;a++)if($rs.unregEvent(f[a],"click",ReadSpeakerDefer.clickhandler),b=f[a]?$rs.getAttr(f[a],
"data-rsevent-id"):"_bogus_",rspkr.l.f.eq.store[b]&&rspkr.l.f.eq.store[b].click)rspkr.log("[rspkr.ui] Click event already existed on "+f[a],2);else{$rs.regEvent(f[a],"click",function(h){t(h);window.readpage(this)});rspkr.ui.addFocusHandler(f[a],!0,f[a].parentNode);rspkr.log("[rspkr.ui] Added click event to: "+f[a],1);try{$rs.getAttr(f[a],"role")||$rs.setAttr(f[a],"role","button")}catch(g){rspkr.log("[rspkr.ui] Could not add role attribute.",2)}}},y=function(){rspkr.log("[rspkr.ui] Initiating global callbacks");
rspkr.ui.rsbtnClass=rspkr.cfg.item("ui.rsbtnClass")||"rsbtn";window.readpage=function(f,a){rspkr.ui.initrun&&rspkr.ui.showPlayer(f,a)};window.rshlexit=function(f){(void 0===f||"false"===f)&&b.stop();setTimeout(function(){rspkr.c.dispatchEvent("onAfterSyncExit",window)},1E3)};window.rshlinit=n().sync.init;window.rshlsetContent=n().sync.setContent;window.rshlsetId=n().sync.setId;window.rshlsync=function(f,a){for(var b=f.split(","),e=a.split(","),h=0,m=f.length;h<m;h++)n().sync.execute(b[h],e[h])};var f=
rspkr.c.data.browser;f&&(/iphone|ipad|ios|android/i.test(f.OS)||"android"==f.name.toLowerCase())?$rs.regEvent(document.body,"touchstart",function(f){rspkr.c.data.setSelectedText(f);return!0}):($rs.regEvent(document.body,"mousedown",function(f){rspkr.ui.setPointerPos(f);return!0}),$rs.regEvent(document.body,"mouseup",function(a){"opera"===f.name.toLowerCase()?setTimeout(function(){rspkr.c.data.setSelectedText(a)},50):rspkr.c.data.setSelectedText(a);return!0}),$rs.regEvent(window,"mouseup",function(a){"opera"===
f.name.toLowerCase()?setTimeout(function(){rspkr.c.data.setSelectedText(a)},50):rspkr.c.data.setSelectedText(a);return!0}),$rs.regEvent(document.body,"keydown",rspkr.ui.setPointerPos),$rs.regEvent(document.body,"keyup",function(f){rspkr.c.data.setSelectedText(f);return!0}))},r=function(){document.removeEventListener?document.removeEventListener("click",window.ReadSpeakerDefer.clickhandler,!1):document.detachEvent&&document.detachEvent("onclick",window.ReadSpeakerDefer.clickhandler);if(ReadSpeakerDefer.deferred){var f=
ReadSpeakerDefer.deferred,a=null;if("a"!=f.tagName.toLowerCase()){for(a=f;"body"!=a.tagName.toLowerCase()&&!(a=a.parentNode,"a"==a.tagName.toLowerCase()););f=a}ReadSpeakerDefer.isRSLink(f)&&(rspkr.log("[rspkr.ui] Activating deferred element: "+f),$rs.removeClass(f.parentNode,"rsdeferred"),rspkr.ui.showPlayer(f));ReadSpeakerDefer.deferred=null}},w=null,c=function(){w&&$rs.isVisible(w)&&(rspkr.log("[rspkr.ui.updateFocus] "+w.outerHTML),u(w))},u=function(f){$rs.focus&&("function"==typeof $rs.focus&&
f)&&$rs.focus(f)},a=function(f){if("iconon"==rspkr.st.get("hlicon")&&!x){var a=p.push(new j)-1;p[a].id=a;p[a].show(f);x=!0}},e=function(){"iconon"==rspkr.st.get("hlicon")&&x&&(p.pop().hide(),x=!1)},j=function(){var f=0,a=0,b=null,e=52,g=null,h=null,m=null,c=function(h){h=h||b;$rs.addClass(h,rspkr.ui.rsbtnClass+" rspopup");rspkr.cfg.item("general.useCompactPopupButton")&&$rs.addClass(h,"rscompact")},j=function(f){$rs.unregEvent(b,"mouseout",i);window.clearTimeout(g);var a,e=b.clientWidth+10,v;h=rspkr.ui.showPlayer(m,
b,!0);v=h.getWidth();a=parseInt($rs.offset(b).left);if((a=rspkr.ui.viewport.width+$rs.scrollLeft(document)-a)<v)a=parseInt($rs.css(b,"left"))-(v-(e-10)),$rs.css(b,"left",a+"px");x=!1;$rs.unregEvent(m,"click",j);$rs.regEvent(m,"click",function(f){t(f);return h.restart()});t(f);return!1},i=function(){g||(g=window.setTimeout(function(){k()},rspkr.cfg.item("general.popupCloseTime")||2E3))},l=function(){g&&(window.clearTimeout(g),g=null)},q=function(h,f){var a=$rs.offset(document.body);$rs.css(b,{top:f-
a.top+"px",left:h-a.left+"px",width:e+"px"})},k=function(){$rs.css(b,{display:"none",top:0,left:0});l();p.splice(null,1);x=!1;b.parentElement.removeChild(b)},n=rspkr.c.findFirstRSButton(),b=document.createElement("div");b.id=rspkr.getID();b.innerHTML=rspkr.cfg.item("ui.popupbutton").join("");c();m=$rs.findIn(b,"a.rsbtn_play");m.href=n?n.href:null;n||(m.href=rspkr.cfg.item("general.popupHref"));var n=m.href.match(/lang=([^&;]*)/i).pop(),r=$rs.findIn($rs.get(b),"a.rsbtn_play span.rsbtn_text span");
r&&(r.textContent=r.innerText=rspkr.cfg.getPhrase("listen",n,"en_us"));$rs.setAttr(m,"title",rspkr.cfg.getPhrase("listentoselectedtext",n,"en_us"));$rs.regEvent(m,"click",j);document.body.appendChild(b);return{setPos:q,show:function(h){l(h);if(h&&"none"==$rs.css(b,"display")){var m=b.cloneNode(!0);m.id=rspkr.getID();$rs.css(m,{display:"block",position:"absolute",top:0,left:0});document.body.appendChild(m);e=$rs.outerWidth(m)+3;document.body.removeChild(m);m=h.pageX;h=h.pageY;a=h>rspkr.ui.pointerY?
h-$rs.scrollTop(document)+36>rspkr.ui.viewport.height-46?h-66:h+30:10>h-$rs.scrollTop(document)-66?h+30:h-51;f=10>m-$rs.scrollLeft(document)?m+10:m-$rs.scrollLeft(document)>rspkr.ui.viewport.width-(e+10)?rspkr.ui.viewport.width+$rs.scrollLeft(document)-(e+10):m+0;q(f,a)}$rs.regEvent(b,"mouseout",i);$rs.regEvent(b,"mouseover",l);i(null);c();$rs.css(b,"display","block")},hide:k,id:null}},i={update:function(f,a,e){"hlspeed"===f&&a!==e&&(f=f.replace("hl",""),rspkr.c.converter[f]&&"function"==typeof rspkr.c.converter[f]&&
(a=rspkr.c.converter[f](a)),rspkr.c.data[f]=a,b&&b.stop(),rspkr.pl.releaseAdapter())}},l=function(f,a,b,e,g,h){$rs.css(f,"background-color","rgb("+a+","+b+","+e+")");e<g?(e+=10,window.setTimeout(function(){l(f,a,b,e,g,h)},50)):h&&"function"===typeof h&&h.apply(f,[])},n=function(){return rspkr.XP?rspkr.XP:rspkr.HL};_expand=function(f){"string"==typeof f&&(f=$rs.get(f));$rs.isArray(f)||(f=[f]);var a=rspkr.cfg.getPhrases(rspkr.c.data.getParam("lang")),b=rspkr.c.data.browser,e=function(h){return $rs.closest(h,
"div."+rspkr.ui.rsbtnClass)},g=function(){j(this)},h=function(){var h=$rs.findIn(e(this),".rsbtn_play");$rs.removeClass(e(this),"rsstopped rsplaying rspaused rsexpanded");j(this);h.click()},m=function(){$rs.removeClass(e(this),"rsstopped rsplaying rspaused rsexpanded");j(this)},c=function(){var h=e(this);rspkr.ui.Lightbox.show(rspkr.st.getHTML(),rspkr.st.getButtons(),!0,function(){rspkr.c.dispatchEvent("onSettingsLoaded",window,[]);rspkr.cfg.execCallback("cb.ui.settingsopened",h)})},j=function(f){f=
e(f);$rs.unregEvent($rs.findIn(f,".rsbtn_pause"),"click",h);$rs.unregEvent($rs.findIn(f,".rsbtn_closer"),"click",m);$rs.unregEvent($rs.findIn(f,".rsbtn_settings"),"click",c);$rs.unregEvent($rs.findIn(f,".rsbtn_play"),"click",g);$rs.removeClass(f,"pre-expanded")},i;for(i in f){$rs.addClass(f[i],"rsexpanded rsstopped");var l=$rs.findIn(f[i],".rsbtn_powered");if(l){var q=$rs.findIn(l,".rsbtn_btnlabel"),n=a.speechenabled.match(/.*href="([^"]*)"/i).pop(),k=a.newwindow,p=document.createElement("p");p.innerHTML=
a.speechenabled;k=(p.innerText||p.textContent)+(k?" ("+k+")":"");q&&(q.innerHTML=a.speechenabled);$rs.setAttr(l,"title",k);$rs.setAttr(l,"data-readspeaker-href",n);q=$rs.getAttr(l,"data-rsevent-id");(!q||rs.l.f.eq.store[q]&&!rs.l.f.eq.store[q].click)&&$rs.regEvent(l,"click",function(){window.open($rs.getAttr(this,"data-readspeaker-href"))});if(l=$rs.findIn(l,".rsbtn_btnlabel a"))(/Chrome|Safari|Opera/gi.test(b.name)||/Explorer/gi.test(b.name)&&8<=b.version)&&$rs.regEvent(l,"click",function(h){t(h)}),
l.innerHTML='<span class="rsbtn_label_read">Read</span><span class="rsbtn_label_speaker">Speaker</span><span class="rsbtn_label_icon rsimg"></span>'}$rs.addClass(f[i],"pre-expanded");$rs.removeClass($rs.findIn(f[i],".rsbtn_progress_container"),"rsloading");$rs.regEvent($rs.findIn(f[i],".rsbtn_closer"),"click",m);$rs.regEvent($rs.findIn(f[i],".rsbtn_pause"),"click",h);$rs.regEvent($rs.findIn(f[i],".rsbtn_play"),"click",g);$rs.regEvent($rs.findIn(f[i],".rsbtn_settings"),"click",c)}};_animate=function(){var f=
rs.cfg.item("ui.animate");if(f){var a,b=15,e=500;"object"==typeof f?(f.id&&(a=$rs.get(f.id)),f.count&&(b=f.count),f.interval&&(e=f.interval)):"string"===typeof f&&(a=$rs.get(f));if("boolean"===typeof f&&f||$rs.isArray(a)&&0==a.length||!a)a=$rs.get("."+rs.ui.rsbtnClass);$rs.isArray(a)||(a=[a]);var g=b,h=setInterval(function(){0==g&&($rs.removeClass(a,"rsanimate"),clearInterval(h));1==g--%2?$rs.addClass(a,"rsanimate"):$rs.removeClass(a,"rsanimate")},e)}};return{meta:{revision:"2873"},initrun:!1,init:function(){evt=
rspkr.Common.addEvent;ui=rspkr.ui;evt("onAfterModsLoaded",y);evt("onReady",k);evt("onReady",r);evt("onReady",_animate);evt("onSelectedText",a);evt("onDeselectedText",e);evt("onSettingsChanged",i.update);evt("onAfterSyncInit",c);this.initrun=!0;rspkr.Common.dispatchEvent("onUIInitialized");rspkr.log("[rspkr.ui] Initialized!")},addFocusHandler:function(a,b,e){var g=b,c=e,c=c||a;void 0===g&&(g=!0);$rs.focusIn&&"function"==typeof $rs.focusIn&&($rs.focusIn(a,function(){$rs.addClass(c,"rsfocus");!0===g&&
(w=a);rspkr.Common.dispatchEvent("onFocusIn",window,[a,c])}),$rs.focusOut(a,function(){$rs.removeClass(c,"rsfocus");rspkr.Common.dispatchEvent("onFocusOut",window,[a,c])}))},focus:function(a){u(a)},updateFocus:function(){c()},showOverlay:function(a,e){var g=a,c;c=e||b.getContainer();var j=$rs.findIn(c,".rsbtn_status");0===j.length&&(j=document.createElement("span"),j.className="rsbtn_status_overlay",j.innerHTML='<span class="rsbtn_status"></span>',$rs.findIn(c,".rsbtn_exp").appendChild(j),j=$rs.findIn(c,
".rsbtn_status"));$rs.css($rs.findIn(c,".rsbtn_status_overlay"),"display","block");if("nosound"===g)g='<a class="rsbtn_nosound">'+rspkr.cfg.getPhrase("nosound")+"</a>",j.innerHTML=g,(g=$rs.findIn(c,".rsbtn_nosound"))&&$rs.regEvent(g,"click",function(){return b.nosound()});else if("loaderror"===g){var g=rspkr.c.data.getSaveData("link"),h=document.createElement("a");window.iframeLoaded=function(h){delete window.iframeLoaded;if("Explorer"!=rs.c.data.browser.name){var a=h.contentWindow.document,f=a.head||
a.getElementsByTagName("head")[0],b=document.createElement("style");b.type="text/css";b.styleSheet?b.styleSheet.cssText="pre { white-space: normal; }":b.appendChild(a.createTextNode("pre { white-space: normal; }"));f.appendChild(b);try{var e=decodeURIComponent(h.contentWindow.location.href),g=-1!=e.indexOf(" ")?e.indexOf(" "):0,c=e.lastIndexOf("/",g)+1,j=e.substr(c);a.body.innerHTML=j}catch(i){}}};h.className="rsbtn_loaderror";h.innerHTML="[?]";h.href=g;$rs.regEvent(h,"click",function(a){rspkr.ui.Lightbox.show("<iframe src='"+
h.href+"' style='height:100%' onload='window.iframeLoaded(this)'></iframe>",null,!1,null,300);t(a)});j.innerHTML=rspkr.cfg.getPhrase("loaderror");j.appendChild(h)}else j.innerHTML=g},settings:i,rsbtnClass:"",addClickEvents:function(){k()},initGlobalCallbacks:function(){y()},showPopupIcon:function(f){a(f)},processDeferred:function(){r()},showPlayer:function(a,e,c){var j;a:{var i=c;rspkr.log("[rspkr.ui.showPlayer]");i=i||!1;if("string"==typeof a)b:{for(var c=$rs.get("a"),h=0,m=c.length;h<m;h++)if(c[h].href&&
c[h].href==a){c=c[h];break b}c=!1}else c=a;if((c=(h=c)?$rs.closest(h,".rsexpanded"):void 0)&&!$rs.isArray(c)&&rspkr.ui.getActivePlayer())rspkr.log("Player already active, calling Player.restart() instead"),rspkr.ui.getActivePlayer().restart(),j=void 0;else{rspkr.c.dispatchEvent("onBeforeParamsSet",window,[h]);c="string"==typeof a?a:h.href;m=null;"string"==typeof a&&(a=c.match(/readid=[^&]+/gi),m=c.match(/readclass=[^&]+/gi),a&&0<a.length&&rspkr.HL.Restore.Storage.readId.push(a[0].replace("readid=",
"").split(",")),m&&0<m.length&&rspkr.HL.Restore.Storage.readClass.push(m[0].replace("readclass=","").split(",")));rspkr.c.data.setParams(c);void 0!==$rs.getAttr(h,"data-target")&&null!==$rs.getAttr(h,"data-target")&&(a=$rs.getAttr(h,"data-target"),a=$rs.get(a),"object"===typeof a&&(e=a));e&&!i?(m=$rs.get(e),$rs.addClass(m,rspkr.ui.rsbtnClass+" rsfloating"),rspkr.basicMode&&($rs.removeClass(m,"rshidden"),$rs.addClass(m,rspkr.ui.rsbtnClass+" rsvisible"))):m=$rs.closest(h,"div."+rspkr.ui.rsbtnClass);
if(!0===rspkr.cfg.item("survey.allowed"))if(e=rspkr.c.cookie,i=rspkr.cfg.item("survey.cookieName")||"rspkrsurvey",a=rspkr.cfg.item("survey.cookieLifetime")||15552E6,h=rspkr.c.data.params,"1"===e.readKey(i,"nmbrdisplays")){rspkr.ui.Lightbox.show(rspkr.cfg.item("survey.url")+"?customerid="+h.customerid+"&lang="+h.lang,rspkr.st.r().replaceTokens(rspkr.cfg.item("ui.survey.buttons").join(),{rsSURVEY_BUTTON_CLOSErs:rspkr.cfg.getPhrase("close")}),!0,function(){$rs.regEvent($rs.get("#rssurvey_button_close"),
"click",rspkr.u.Lightbox.hide)},500);rspkr.log(e.updateKey(i,"nmbrdisplays","displayed",a),4);j=void 0;break a}else void 0===e.readKey(i,"nmbrdisplays")&&rspkr.log(e.updateKey(i,"nmbrdisplays","1",a),4);b:{e=m;for(j in g)if(g[j]&&g[j].getContainer&&g[j].getContainer()==e){j=g[j];break b}j=new rspkr.ui.Player(e);g.push(j)}if(b&&b!=j||b&&c!==b.getHref())b.close(!0),rspkr.c.dispatchEvent("onUIClosePlayer",b.getContainer(),[0<rspkr.c.data.selectedText.length?"textsel":"nosel"]);e=(e=b)?e.getID():null;
rspkr.c.dispatchEvent("onUIShowPlayer",window,[e,j.getID()]);j.setHref(c);j.show();j=b=j}}return j},expand:function(a){_expand(a)},pointerX:0,pointerY:0,setPointerPos:function(a){rspkr.ui.pointerX=a.pageX;rspkr.ui.pointerY=a.pageY;return!0},viewport:{width:$rs.width(window),height:$rs.height(window)},popups:p,hl:function(a,b){window.setTimeout(function(){l(a,255,255,100,255,b)},200)},scroll:{INTERVAL:null,STEPS:25,scrollToElm:function(a){$rs.isVisible(a)&&this.initScroll(a)},scrollToAnchor:function(a){for(var b=
$rs.get("a"),e=null,g=0;g<b.length;g++){var c=b[g];if(c.name&&c.name==a){e=c;break}}this.initScroll(e)},initScroll:function(a){if(a){for(var b=a.offsetTop,e=a;e.offsetParent&&e.offsetParent!=document.body;)e=e.offsetParent,b+=e.offsetTop;b-=50;rs.cfg.item("ui.autoscrollOffset")&&!isNaN(rs.cfg.item("ui.autoscrollOffset"))&&(b-=rs.cfg.item("ui.autoscrollOffset"));clearInterval(rspkr.u.scroll.INTERVAL);var e=rspkr.u.scroll.getCurrentYPos(),g=parseInt((b-e)/rspkr.u.scroll.STEPS);rspkr.u.scroll.INTERVAL=
setInterval(function(){rspkr.u.scroll.scrollWindow(g,b,a)},10)}else document.location.hash=a},getCurrentYPos:function(){return document.body&&document.body.scrollTop?document.body.scrollTop:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:window.pageYOffset?window.pageYOffset:0},scrollWindow:function(a,b,e){var g=rspkr.u.scroll.getCurrentYPos(),c=g<b;window.scrollTo(0,g+a);a=rspkr.u.scroll.getCurrentYPos();if(c!=a<b||g==a)window.scrollTo(0,b),clearInterval(rspkr.u.scroll.INTERVAL),
"string"==typeof e&&(location.hash=e)}},activePlayer:b,getActivePlayer:function(){return b}}}();
ReadSpeaker.ui.Slider=function(){var b=this,g={handleClass:"",width:0,height:0,left:0,top:0,steps:-1,stepsize:-1,dir:"h",initval:-1,drop:null,start:null,dragging:null,click:null,labelDragHandle:"",labelStart:"",labelEnd:"",nudge:1},p={rsid:void 0,parent:void 0,ref:void 0},x=void 0,t=void 0,k=void 0,y=void 0,r=void 0,w=!1,c=0,u=function(a){a=a||window.event;a.returnValue=!1;if(a=a.originalEvent)a.cancelBubble=!0,a.returnValue=!1;a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation()};
this.initElement=function(a){if(!w){"string"==typeof a&&(a=document.getElementById(a));a.innerHTML+='<a href="javascript:void(0);" role="slider" class="keyLink" style="display:block; border:0;">&#160;</a>';var b=a.getElementsByTagName("a"),b=b[b.length-1],j=-1<g.steps?g.steps:100;b.relatedElement=a;$rs.setAttr(b,"title",g.labelDragHandle);$rs.setAttr(b,"aria-label",g.labelDragHandle);$rs.setAttr(b,"aria-orientation","h"==g.dir?"horizontal":"vertical");$rs.setAttr(b,"aria-valuemin",0);$rs.setAttr(b,
"aria-valuemax",j);$rs.setAttr(b,"aria-valuenow",g.initval||0);c=g.initval;$rs.regEvent(a,"mousedown",this.startDragMouse);$rs.regEvent(b,"click",function(a){u(a)});$rs.regEvent(b,"keyup",this.startDragKeys);$rs.regEvent(b,"dragstart",function(a){u(a)});$rs.regEvent(a,"touchstart",this.touchStart);$rs.regEvent(p.parent,"mousedown",this.mouseClick)}};this.mouseClick=function(a){if(!w&&!$rs.hasClass(p.ref,"dragged")){var e=b.findPos(a.target),c=a.clientX-(e.left-g.left),a=a.clientY-(e.top-g.top);k=
e.left;y=e.top;e=b.getCurrentVal({left:c,top:a});"function"==typeof g.click&&g.click(e,p);return!1}};this.findPos=function(a){var b=curTop=0;if(a.offsetParent){do b+=a.offsetLeft,curTop+=a.offsetTop;while(a=a.offsetParent);return{left:b,top:curTop}}};this.startDragMouse=function(a){rspkr.log("[rspkr.ui.Slider] startDragMouse");if(!w){b.startDrag(this);var e=a||window.event;x=e.clientX;t=e.clientY;$rs.regEvent(document.body,"mousemove",b.dragMouse);$rs.regEvent(document.body,"mouseup",b.releaseElement)}u(a);
return!1};this.startDragKeys=function(a){rspkr.log("[rspkr.ui.Slider] startDragKeys "+(a||window.event).keyCode);b.startDrag(this.relatedElement);$rs.regEvent(document.body,"keydown",b.dragKeys);$rs.regEvent(document.body,"keypress",b.switchKeyEvents);$rs.addClass(this.relatedElement,"rskeycontrolled");u(a)};this.touchStart=function(a){a=a.originalEvent;rspkr.log("[rspkr.ui.Slider] touchStart");w||(b.startDrag(a.target),x=a.touches[0].pageX,t=a.touches[0].pageY,$rs.regEvent(a.target,"touchmove",b.touchMove),
$rs.regEvent(a.target,"touchend",b.releaseElement));return!1};this.startDrag=function(a){rspkr.log("[rspkr.ui.Slider] startDrag");r&&b.releaseElement();k=a.offsetLeft;y=a.offsetTop;r=a;$rs.addClass(r,"dragged");"function"==typeof g.start&&g.start(p)};this.dragMouse=function(a){a=a||window.event;b.setPosition(a.clientX-x,a.clientY-t);b.valueChanged=!0;return!1};this.touchMove=function(a){u(a);b.setPosition(a.touches[0].pageX-x,a.touches[0].pageY-t);b.valueChanged=!0;return!1};this.dragKeys=function(a){switch((a||
window.event).keyCode){case 37:case 63234:b.valueChanged=!0;c-=g.nudge;break;case 38:case 63232:b.valueChanged=!0;c+=g.nudge;break;case 39:case 63235:b.valueChanged=!0;c+=g.nudge;break;case 40:case 63233:b.valueChanged=!0;c-=g.nudge;break;case 13:case 27:return b.releaseElement(),!1;case 9:return b.releaseElement(),!0;default:return rspkr.log("[rspkr.ui.Slider] return TRUE"),!0}!0===b.valueChanged&&(rspkr.c.dispatchEvent("onUISliderMove"),"function"==typeof g.dragging&&g.dragging(b.getCurrentVal({skipValueCalculation:!0}),
p));u(a);rspkr.log("[rspkr.ui.Slider] ready to return!");return!1};this.setPosition=function(a,e){var c,i=!1;c=a;var l=k,n=g.left,f=g.width,v="left";"v"==g.dir&&(c=e,l=y,n=g.top,f=g.height,v="top");c=l+c;-1<g.stepsize&&((c+n)%g.stepsize?c=g.stepsize*Math.ceil(c/g.stepsize)+n:i=!0);c>f+n?c=f+n:c<n&&(c=n);i||(r.style[v]=c+"px","function"==typeof g.dragging&&g.dragging(b.getCurrentVal(),p))};this.switchKeyEvents=function(){$rs.unregEvent(document.body,"keydown",b.dragKeys);$rs.unregEvent(document.body,
"keypress",b.switchKeyEvents);$rs.regEvent(document.body,"keypress",b.dragKeys)};this.releaseElement=function(){rspkr.log("[rspkr.ui.Slider] releaseElement");$rs.unregEvent(document.body,"mousemove",b.dragMouse);$rs.unregEvent(document.body,"mouseup",b.releaseElement);$rs.unregEvent(document.body,"keypress",b.dragKeys);$rs.unregEvent(document.body,"keypress",b.switchKeyEvents);$rs.unregEvent(document.body,"keydown",b.dragKeys);$rs.unregEvent(r,"touchmove",b.touchMove);$rs.unregEvent(r,"touchend",
b.releaseElement);$rs.removeClass(r,"dragged");$rs.removeClass(r,"rskeycontrolled");$rs.removeClass(r,"rsmousecontrolled");var a=b.getCurrentVal();r=null;"function"==typeof g.drop&&!0===b.valueChanged&&g.drop(a,p);b.valueChanged=!1;rs.ui.getActivePlayer()&&rs.ui.getActivePlayer().setProgress();return!1};this.getCurrentVal=function(a){var b,j=g.width;b="left";var i=g.left;"v"==g.dir&&(j=g.height,b="top",i=g.top);var l=-1<g.steps?g.steps:100,j=-1<g.stepsize?g.stepsize:j/l,a=a?a[b]:$rs.css(p.ref,b).replace(/px/i,
"");pos=Math.round(a)-i;b=Math.round(pos/j);"v"==g.dir&&(b=l-b);rspkr.log("[rspkr.ui.Slider] currentval: "+b);return a&&a.skipValueCalculation||isNaN(b)?c=Math.max(Math.min(c,l),0):c=b};return{init:function(a,e){"string"==typeof a&&(a=document.getElementById(a));if(a){var c=a.id||"data-readspeaker-slider-id-"+Math.floor(2E4*Math.random());a.setAttribute&&a.setAttribute("data-readspeaker-slider-id-","data-readspeaker-slider-parent-"+c);var i={width:function(){return $rs.width(a)},height:function(){return $rs.height(a)}};
if("object"==typeof e)for(var l in e)e.hasOwnProperty(l)&&void 0!==g[l]&&(g[l]=e[l]);l=!1;var k;"rsbtn_volume_slider"===a.className&&("jquery"===rspkr.l.f.currentLib()&&1.5>parseFloat(jQuery.fn.jquery))&&(k=a.parentNode.style.display,a.parentNode.style.display="block",l=!0);g.width=i.width();g.height=i.height();l&&(a.parentNode.style.display=k);-1<g.steps&&(g.stepsize=("h"==g.dir?g.width:g.height)/g.steps);i=document.createElement("span");i.setAttribute("data-readspeaker-slider-id-",c);i.className=
g.handleClass||"rsbtn_progress_handle rsimg";a.appendChild(i);p.rsid=c;p.parent=a;p.ref=i;c=$rs.css(i,"left");null!==c&&(g.left=parseInt(c.replace(/px/i,"")));c=$rs.css(i,"top");null!==c&&(g.top=parseInt(c.replace(/px/i,"")));-1<g.initval&&this.jumpTo(g.initval);g.labelStart&&(c=document.createElement("span"),c.className="slider-label-start",c.innerHTML=g.labelStart,a.appendChild(c));g.labelEnd&&(c=document.createElement("span"),c.className="slider-label-end",c.innerHTML=g.labelEnd,a.appendChild(c));
b.initElement(i)}},jumpTo:function(a){if(isNaN(a))return!1;var b=101,c=a;-1<g.steps&&(a=Math.round(a),b=g.steps+1);if(-1<a&&a<b){var i=g.width,l=g.left,k="left";"v"==g.dir&&(i=g.height,l=g.top,k="top",a=b-1-a);p.ref.style[k]=i/(b-1)*a+l+"px";$rs.setAttr($rs.findIn(p.ref,"a.keyLink"),"aria-valuenow",c)}},setCurrentValue:function(a){c=a},getInstance:function(){return p},getContainer:function(){return p.parent},releaseElement:function(){b.releaseElement()},startDragKeys:function(a,e){b.startDragKeys.call(a,
e)},disabled:function(){if(arguments)w=arguments[0];else return w}}};
ReadSpeaker.ui.Player=function(b){var g=function(a){a=a||window.event;a.returnValue=!1;if(a=a.originalEvent)a.cancelBubble=!0,a.returnValue=!1;a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation()},p=rspkr.getID(),x=this,t=[],k=0,y=!1,r=null,w=!1,c={_play:null,_pause:null,_stop:null,_vol:null,_settings:null,_dl:null,_closer:null,_powered:null,_get:function(a,e){var c,a="_"+a;c=b?this[a]&&0<this[a].length?this[a]:this[a]=$rs.findIn(b,e):null;return c==[]?null:c},play:function(){return this._get("play",
".rsbtn_play")},pause:function(){return this._get("pause",".rsbtn_pause")},stop:function(){return this._get("stop",".rsbtn_stop")},vol:function(){return this._get("vol",".rsbtn_volume")},settings:function(){return this._get("settings",".rsbtn_settings")},dl:function(){return this._get("dl",".rsbtn_dl")},pin:function(){return this._get("pin",".rsbtn_pin")},powered:function(){return this._get("powered",".rsbtn_powered")},closer:function(){return this._get("closer",".rsbtn_closer")},nosound:function(){return this._get("nosound",
".rsbtn_nosound")},setPlayPause:function(a){rspkr.log("[rspkr.ui.Player.setPlayPause("+a+")]");a=a?$rs.getAttr(this.pause(),"data-rsphrase-play"):$rs.getAttr(this.pause(),"data-rsphrase-pause");$rs.setAttr(this.pause(),"title",rspkr.c.decodeEntities(a));$rs.findIn(this.pause(),".rsbtn_btnlabel").innerHTML=a}},u=!1,a=[],e={play:function(){rspkr.c.dispatchEvent("onUIBeforePlay");rspkr.log("[rspkr.ui.handlers.play]");a.progress&&a.progress.disabled(!1);e.setStateClass(b,"rsplaying");rspkr.basicMode&&
e.setStateClass($rs.findIn(b,".rsbtn_exp"),"rsplaying");$rs.addClass($rs.findIn(b,".rsbtn_progress_container"),"rsloading");c.setPlayPause(!1);rspkr.pl.play();w&&rspkr.pl.getProgress.apply(rspkr.pl,[!0,i,x]);rspkr.c.addEvent("onBeforeSyncInit",function(){w=!0;rspkr.pl.getProgress.apply(rspkr.pl,[!0,i,x])});"flash"===rspkr.pl.adapter&&!rspkr.displog.onVolumeAdjusted&&rspkr.pl.setVolume(parseInt(rspkr.st.get("hlvol")||"100"));rspkr.c.dispatchEvent("onUIAfterPlay");rspkr.cfg.execCallback("cb.ui.play",
b)},pause:function(){rspkr.log("[rspkr.ui.handlers.pause]");e.setStateClass(b,"rspaused");rspkr.basicMode&&e.setStateClass($rs.findIn(b,".rsbtn_exp"),"rspaused");c.setPlayPause(!0);rspkr.pl.pause();rspkr.pl.getProgress(!1);rspkr.c.dispatchEvent("onUIPause");rspkr.cfg.execCallback("cb.ui.pause",b);rspkr.log("ReadSpeaker.ui.pause")},stop:function(){rspkr.log("[rspkr.ui.handlers.stop]");a.progress&&a.progress.disabled(!0);e.setStateClass(b,"rsstopped");$rs.removeClass($rs.findIn(b,".rsbtn_progress_container"),
"rsloading");rspkr.basicMode&&e.setStateClass($rs.findIn(b,".rsbtn_exp"),"rsstopped");c.setPlayPause(!0);$rs.setAttr(b,"data-readspeaker-current",0);a.progress&&(a.progress.jumpTo(0),j(0));rspkr.pl.stop();rspkr.pl.getProgress(!1);rspkr.c.dispatchEvent("onUIStop",b);rspkr.cfg.execCallback("cb.ui.stop",b);(!document.getElementById("rslightbox_contentcontainer")||!$rs.isVisible(document.getElementById("rslightbox_contentcontainer")))&&c.pause().focus();rspkr.log("ReadSpeaker.ui.stop")},setStateClass:function(a,
b){a&&($rs.removeClass(a,"rspaused rsstopped rsplaying"),$rs.addClass(a,b))},vol:function(h){var e=$rs.findIn(b,".rsbtn_volume_container"),c=$rs.findIn(b,".rsbtn_volume"),h=h.originalEvent,f=function(a){var b=a.originalEvent,b=$rs.closest(b.srcElement||b.originalTarget,".rsbtn_volume_container");if("none"===$rs.css(e,"display"))return!1;if("click"===a.type){if(void 0===b||$rs.isArray(b)&&!b.length)$rs.css(e,"display","none"),$rs.unregEvent(document.body,"click",f)}else"keyup"===a.type&&27===a.keyCode&&
($rs.css(e,"display","none"),$rs.unregEvent(document.body,"keyup",f))};$rs.css(e,"left",c.offsetLeft+"px");$rs.css(e,"display","none"==$rs.css(e,"display")?"block":"none");"block"===$rs.css(e,"display")&&($rs.regEvent(document.body,"click",f),$rs.regEvent(document.body,"keyup",f));h&&h.stopPropagation&&h.stopPropagation();h.cancelBubble=!0;c=$rs.findIn(e,".keyLink");a.vol.startDragKeys(c,{keyCode:13});return!1},settings:function(){$rs.hasClass(b,"rsplaying")&&this.pause();rspkr.ui.Lightbox.show(rspkr.st.getHTML(),
rspkr.st.getButtons(),!0,function(a){var b=$rs.get("rslightbox_closer"),e=function(){document.removeEventListener?b.removeEventListener("click",e,!1):document.detachEvent&&document.detachEvent("onclick",e);rspkr.c.dispatchEvent("onSettingsClosed",window,[])};$rs.regEvent(b,"click",e);rspkr.ui.addClickEvents();rspkr.c.dispatchEvent("onSettingsLoaded",window,[]);rspkr.cfg.execCallback("cb.ui.settingsopened",a)})},close:function(h){e.pin(!0);var h=h||!1,f=rspkr.pl,g=!1;h||rspkr.cfg.execCallback("cb.ui.beforeclose",
b);f.hasOwnProperty("getProgress")&&rspkr.pl.getProgress(!1);f.hasOwnProperty("releaseAdapter")&&rspkr.pl.releaseAdapter();$rs.setAttr(b,"data-readspeaker-current",0);a.progress&&a.progress.jumpTo(0);$rs.removeClass(b,"rsstopped rsplaying rspaused rsexpanded");if(rspkr.basicMode){var i;(i=$rs.findIn(b,".rsbtn_play"))&&$rs.removeClass(i,"rsexpanded")}$rs.hasClass(b,"rsfloating")&&($rs.removeClass(b,rspkr.ui.rsbtnClass),rspkr.basicMode&&($rs.removeClass(b,"rsvisible"),$rs.addClass(b,"rshidden")));c.setPlayPause(!0);
$rs.hasClass(b,"rspopup")&&(g=!0,$rs.removeClass(b,"rspopup"),$rs.css(b,"display","none"),b.parentNode.removeChild(b));$rs.css(b,"width","auto");delete rspkr.displog.onVolumeAdjusted;h||(rspkr.c.dispatchEvent("onUIClosePlayer",b,["userclick"]),rspkr.cfg.execCallback("cb.ui.close",b),rspkr.log("ReadSpeaker.ui.close: "+b));!h&&!1===g&&rspkr.ui.focus($rs.findIn($rs.get(b),".rsbtn_play"))},dl:function(){$rs.hasClass(b,"rsplaying")&&this.pause();var a=rspkr.c.data.getSaveData("dialog"),e=!1;rspkr.log("[rspkr.ui.handlers.dl] Savelink: "+
a);rspkr.u.Lightbox.show(this.getDlDialog(),this.getDlButtons(),!0,function(){var b=$rs.get("#rsdl_button_accept"),c=$rs.get("#rsdl_button_decline");b&&$rs.regEvent(b,"click",function(c){rspkr.u.Lightbox.hide(c);e="iOS"!==rspkr.c.data.browser.OS&&0<rspkr.c.data.selectedHTML.length?!0:"iOS"!==rspkr.c.data.browser.OS&&!0===rspkr.cfg.item("general.usePost")?!0:!1;if(!0===e){c=null;if(document.getElementById("dliframe"))c=document.getElementById("dliframe");else{if(document.selection)try{c=document.createElement('<iframe name="dliframe">')}catch(f){c=
document.createElement("iframe")}else c=document.createElement("iframe");c.name="dliframe";c.setAttribute("id","dliframe");c.setAttribute("style","display: none; position: absolute;");c.style.display="none";var g=document.getElementsByTagName("body"),i=null;0<g.length&&(i=g.item(0));if(i)i.appendChild(c);else return}c.src=a;return!1}$rs.setAttr(b,"href",a);return!0});c&&($rs.regEvent(c,"click",function(a){g(a);rspkr.u.Lightbox.hide(a)}),setTimeout(function(){rspkr.ui.focus(c)},200));rspkr.c.dispatchEvent("onDownloadLoaded",
window,[])})},pin:function(a){var b=rs.ui.getActivePlayer().getContainer(),e=b.id+"_pinnedHome",f=document.getElementById(e);if(!$rs.hasClass(c.pin(),"pinned")&&!a){if($rs.addClass(c.pin(),"pinned"),!f){var f=$rs.clone(b,!1,!0),a=window.getComputedStyle(b),g=b.offsetLeft,i=b.offsetTop;f.style.width=a.getPropertyValue("width").replace(/[^-\d\.]/g,"")-2+"px";f.style.height=a.getPropertyValue("height").replace(/[^-\d\.]/g,"")-2+"px";for(var j="position left right top bottom margin".split(" "),l=0,k;k=
j[l];l++)f.style[k]=a.getPropertyValue(k);b.style.position="fixed";b.style.left=g-document.body.scrollLeft+"px";b.style.top=i-document.body.scrollTop+"px";f.className="rsbtn_pinnedHome rsbtn";for(f.id=e;f.hasChildNodes();)f.removeChild(f.lastChild);b.parentElement.insertBefore(f,b)}}else if($rs.hasClass(c.pin(),"pinned")||a)$rs.removeClass(c.pin(),"pinned"),f&&(f.parentNode.removeChild(f),e=function(a,b){document.body.style.removeProperty?a.style.removeProperty(b):a.style.removeAttribute(b)},e(b,
"position"),e(b,"top"),e(b,"left"))},getDlDialog:function(){var a=rspkr.cfg.item("ui.dldialog").join("\n"),b={};b.rsTERMS_OF_USE_HEADINGrs=rspkr.cfg.getPhrase("touheading");b.rsTERMS_OF_USE_BODYrs=rspkr.cfg.getPhrase("toubody");return rspkr.st.r().replaceTokens(a,b)},getDlButtons:function(){var a=rspkr.cfg.item("ui.dlbuttons").join("\n"),b={};b.rsTERMS_OF_USE_ACCEPTrs=rspkr.cfg.getPhrase("touaccept");b.rsTERMS_OF_USE_DECLINErs=rspkr.cfg.getPhrase("toudecline");return rspkr.st.r().replaceTokens(a,
b)},nosound:function(){var a=rspkr.c.data.getSaveData("link");$rs.setAttr(c.nosound(),"href",a);return!0}},j=function(a){var a=100<a?100:a,e=$rs.findIn(b,".rsbtn_progress_played");"object"===typeof e&&$rs.css(e,"width",a+"%");rspkr.cfg.execCallback("cb.ui.progresschanged",b,[a])},i=function(e){if(e.length){var c=parseInt(e[0]),e=parseInt(e[1]),f=0==e?0:Math.round(100*(c/e)),g=$rs.findIn(b,".rsbtn_current_time"),i=$rs.findIn(b,".rsbtn_total_time"),k,n;a.progress&&(a.progress.setCurrentValue(f),u||
(a.progress.jumpTo(f),j(f),g&&(g.innerHTML=k=l(c)),i&&(i.innerHTML=n=l(e)),rspkr.cfg.execCallback("cb.ui.timeupdated",b,[k,n])));rspkr.log("[rspkr.player.updateProgress] current time: "+c+" total time: "+e);$rs.setAttr(b,"data-readspeaker-current",c);$rs.setAttr(b,"data-readspeaker-buffered",e);0<c&&$rs.removeClass($rs.findIn(b,".rsbtn_progress_container"),"rsloading")}},l=function(a){var a=a/1E3,b=parseInt(a%60),e=parseInt(a/60%60),a=parseInt(a/60/60%60);return(10>a?"0"+a:a.toString())+":"+(10>e?
"0"+e:e.toString())+":"+(10>b?"0"+b:b.toString())},n=function(){u=!0},f=function(a){rspkr.log("_dropProgress ("+a+")",5);a&&(a=a/100*$rs.getAttr(b,"data-readspeaker-buffered")/1E3,rspkr.pl.setProgress(a));u=!1},v=function(a){f(a)},B=function(e){rspkr.log("_dropVolume, "+e,5);e=0>e?0:20*e;a.vol&&a.vol.jumpTo(e/20);rspkr.pl.setVolume(e);rspkr.st.set("hlvol",e);rspkr.cfg.execCallback("cb.ui.volumechanged",b,[e]);return!1},A=function(e,c){if("keyLink"===e.className){var f="";$rs.hasClass(c,"rsbtn_volume_handle")?
f="vol":$rs.hasClass(c,"rsbtn_progress_handle")&&(f="progress");var g={keyCode:13};a[f].startDragKeys(e,g)}else $rs.hasClass(c,"rsbtn_volume")&&(g={keyCode:13},f=$rs.findIn(b,".rsbtn_volume_container"),f=$rs.findIn(f,".keyLink"),a.vol.startDragKeys(f,g))},z=function(b,e){if("keyLink"===b.className){var c="";$rs.hasClass(e,"rsbtn_volume_handle")?c="vol":$rs.hasClass(e,"rsbtn_progress_handle")&&(c="progress");a[c].releaseElement();u=!1}};return{init:function(){t.push([this.show,[]])},show:function(){$rs.rsid(b);
b.id=p=b.id||rspkr.getID();ui=rspkr.ui;$rs.hasClass(b,rspkr.ui.rsbtnClass)||$rs.addClass(b,rspkr.ui.rsbtnClass);var h=null,h=rspkr.cfg,i=rspkr.cfg.getPhrases(rspkr.c.data.getParam("lang"));if(0==$rs.findIn(b,".rsbtn_exp").length){var j=$rs.hasClass(b,"rspopup")?h.item("ui.popupplayer"):h.item("ui.player"),h=document.createElement("div");h.className="rsbtn_exp rsimg rspart";h.innerHTML+=j.join("\n");b.appendChild(h)}"fallback"===rspkr.pl.adapter&&rspkr.ui.showOverlay("nosound",b);h=c.pin();$rs.isArray(h)&&
0==h.length&&(h=void 0);rspkr.cfg.item("ui.usePin")&&h?$rs.removeClass(h,"turnedOff"):h&&h.parentElement.removeChild(h);if(i){h=function(a,b){var e=$rs.findIn(a,".rsbtn_btnlabel");$rs.isArray(e)||(e=[e]);0<e.length&&(e[0].innerHTML=b)};c.pause()&&($rs.setAttr(c.pause(),"data-rsphrase-pause",i.pause),$rs.setAttr(c.pause(),"data-rsphrase-play",i.play),$rs.setAttr(c.pause(),"title",rspkr.c.decodeEntities(i.pause)),h(c.pause(),rspkr.c.decodeEntities(i.pause)));c.stop()&&($rs.setAttr(c.stop(),"title",
rspkr.c.decodeEntities(i.stop)),h(c.stop(),rspkr.c.decodeEntities(i.stop)));c.vol()&&($rs.setAttr(c.vol(),"title",rspkr.c.decodeEntities(i.volume)),h(c.vol(),rspkr.c.decodeEntities(i.volume)));c.settings()&&($rs.setAttr(c.settings(),"title",rspkr.c.decodeEntities(i.settings)),h(c.settings(),rspkr.c.decodeEntities(i.settings)));c.dl()&&($rs.setAttr(c.dl(),"title",rspkr.c.decodeEntities(i.download)),h(c.dl(),rspkr.c.decodeEntities(i.download)));if(c.powered()){var j=$rs.findIn(c.powered(),".rsbtn_btnlabel"),
l=i.speechenabled.match(/.*href="([^"]*)"/i).pop(),r=i.newwindow,t=document.createElement("p");t.innerHTML=i.speechenabled;r=(t.innerText||t.textContent)+(r?" ("+r+")":"");j&&(j.innerHTML=i.speechenabled);$rs.setAttr(c.powered(),"title",r);$rs.setAttr(c.powered(),"data-readspeaker-href",l);j=$rs.getAttr(c.powered(),"data-rsevent-id");(!j||rs.l.f.eq.store[j]&&!rs.l.f.eq.store[j].click)&&$rs.regEvent(c.powered(),"click",function(){window.open($rs.getAttr(this,"data-readspeaker-href"))})}c.closer()&&
($rs.setAttr(c.closer(),"title",rspkr.c.decodeEntities(i.closeplayer)),h(c.closer(),rspkr.c.decodeEntities(i.closeplayer)))}i=rspkr.c.data.browser;(!/safari/i.test(i.name)||!/iphone|ipad|ios/i.test(i.OS))&&$rs.addClass(b,"rs-no-touch");i=$rs.findIn(b,".rsbtn_status_overlay");$rs.isArray(i)||$rs.css(i,"display","none");$rs.addClass(b,"rsexpanded");if(rspkr.basicMode){var q;(q=$rs.findIn(b,".rsbtn_play"))&&$rs.addClass(q,"rsexpanded")}y||(c.stop()&&($rs.regEvent(c.stop(),"click",function(a){g(a);e.stop()}),
ui.addFocusHandler(c.stop())),c.pause()&&($rs.regEvent(c.pause(),"click",function(a){g(a);$rs.hasClass(b,"rsplaying")?e.pause():($rs.hasClass(b,"rsstopped")||$rs.hasClass(b,"rspaused"))&&e.play()}),ui.addFocusHandler(c.pause())),c.closer()&&($rs.regEvent(c.closer(),"click",function(a){g(a);e.close()}),ui.addFocusHandler(c.closer())),c.vol()&&($rs.regEvent(c.vol(),"click",function(a){g(a);e.vol(a)}),ui.addFocusHandler(c.vol())),c.dl()&&($rs.regEvent(c.dl(),"click",function(a){g(a);return e.dl()}),
ui.addFocusHandler(c.dl())),c.settings()&&($rs.regEvent(c.settings(),"click",function(a){g(a);e.settings()}),ui.addFocusHandler(c.settings())),c.pin()&&($rs.regEvent(c.pin(),"click",function(a){g(a);e.pin()}),ui.addFocusHandler(c.pin())),q=rspkr.cfg,$rs.setAttr(b,"data-readspeaker-current",0),$rs.setAttr(b,"data-readspeaker-buffered",0),$rs.isArray($rs.findIn($rs.get(b),".rsbtn_progress_container"))||(a.progress=new rspkr.ui.Slider,a.progress.init($rs.findIn($rs.get(b),".rsbtn_progress_container"),
{handleClass:q.item("ui.progressHandleClass")||"rsbtn_progress_handle rsimg",dir:q.item("ui.progressDir")||"h",nudge:5,start:n,dragging:f,click:v,labelDragHandle:q.getPhrase("sliderseek")}),i=$rs.findIn($rs.get(b),".rsbtn_progress_handle a"),ui.addFocusHandler(i,!1,i.parentNode)),$rs.isArray($rs.findIn($rs.get(b),".rsbtn_volume_slider"))||(i=rspkr.st.get("hlvol")||"100",i=5*(parseInt(i)/100),a.vol=new rspkr.ui.Slider,a.vol.init($rs.findIn(b,".rsbtn_volume_slider"),{handleClass:q.item("ui.volumeHandleClass")||
"rsbtn_volume_handle rsimg",dir:q.item("ui.volumeDir")||"v",steps:5,nudge:1,initval:i,dragging:B,click:B,labelDragHandle:q.getPhrase("slidervolumedesc")}),i=$rs.findIn($rs.get(b),".rsbtn_volume_handle a"),ui.addFocusHandler(i,!1,i.parentNode)),rspkr.Common.addEvent("onFocusIn",A),rspkr.Common.addEvent("onFocusOut",z),rspkr.cfg.execCallback("cb.ui.open",b),y=!0);if($rs.findIn(b,".rsbtn_powered")&&(q=$rs.findIn(b,".rsbtn_powered .rsbtn_btnlabel a")))(/Chrome|Safari|Opera/gi.test(rs.c.data.browser.name)||
/Explorer/gi.test(rs.c.data.browser.name)&&8<=rs.c.data.browser.version)&&$rs.regEvent(q,"click",function(a){g(a)}),q.innerHTML='<span class="rsbtn_label_read">Read</span><span class="rsbtn_label_speaker">Speaker</span><span class="rsbtn_label_icon rsimg"></span>';"0"!=$rs.getAttr(b,"data-readspeaker-current")&&(rspkr.pl.releaseAdapter(),$rs.setAttr(b,"data-readspeaker-current",0));"fallback"!==rspkr.pl.adapter&&(e.play(),rspkr.ui.focus(c.pause()));q=(q=b)||b;q=$rs.clone(q,!0,!0);q.id=rspkr.getID();
document.body.appendChild(q);$rs.css(q,{position:"absolute",top:"0",left:"0",display:"block",width:"auto"});$rs.css(q,"float","none");$rs.addClass(q,"rsexpanded");i=$rs.outerWidth(q)+3;q.style.display="none";document.body.removeChild(q);k=i;isNaN(k)||$rs.css(b,"width",k+(/[Ee]xplorer/.test(ReadSpeaker.c.data.browser.name)?1:0)+"px")},close:function(a){e.close(a)},stop:function(){e.stop()},nosound:function(){return e.nosound()},pause:function(){e.pause()},play:function(){e.play()},restart:function(){rspkr.log("[rspkr.ui.restart]");
e.stop();window.setTimeout(function(){e.play()},500);return!1},updateProgress:function(a){i(a)},setProgress:function(a){f(a)},getContainer:function(){return b},getID:function(){return p},getWidth:function(){return k},setHref:function(a){r=a},getHref:function(){return r}}};
ReadSpeaker.ui.Lightbox=function(){var b=null,g=null,p=null,x=null,t=null,k=null,y,r=[],w=function(a){a=a||window.event;a.returnValue=!1;if(a=a.originalEvent)a.cancelBubble=!0,a.returnValue=!1;a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation()},c=function(){$rs.css(k,"display","none");var a=$rs.height(window),b=$rs.height(document),c=parseInt($rs.css(document.documentElement,"width")),g=$rs.width(document),n=$rs.absOffset(document.body),f=0,p=0;isNaN(c)&&(c=$rs.width(window));
n.left&&(p=n.left);n.top&&(f=n.top);$rs.css(t,{width:(g>c?g:c)+"px",height:(b>a?b:a)+"px",top:"-"+Math.abs(f)+"px",left:"-"+Math.abs(p)+"px"});$rs.css(k,"display","block");u()},u=function(){var a=$rs.outerWidth(k),b=$rs.outerHeight(k),c=$rs.width(window),g=$rs.height(window),b=y+80+50<g?y+80:g-50;k.style.height=b+"px";$rs.get("#rslightbox_content").style.height=b-80+"px";b>g?(k.style.top=$rs.scrollTop(document)+"px",k.style.marginTop="10px"):(k.style.top=g/2+"px",k.style.marginTop=-(b/2-$rs.scrollTop(document))+
"px");a>c?(k.style.left=$rs.scrollLeft(document)+"px",k.style.marginLeft="0"):(k.style.left="50%",k.style.marginLeft=-(a/2-$rs.scrollLeft(document))+"px")},a=function(a){27===a.keyCode&&rspkr.ui.Lightbox.hide()};return{init:function(){var a=rspkr.pub.Config;b=a.item("ui.overlay.overlayStyles");g=a.item("ui.overlay.contentStyles");p=a.item("ui.overlay.contentTemplate");document.querySelectorAll||(d=document,s=d.createStyleSheet(),d.querySelectorAll=function(a,b,c,e,f){f=d.all;b=[];a=a.replace(/\[for\b/gi,
"[htmlFor").split(",");for(c=a.length;c--;){s.addRule(a[c],"k:v");for(e=f.length;e--;)f[e].currentStyle.k&&b.push(f[e]);s.removeRule(0)}return b});rspkr.log("[rspkr.ui.Lightbox] Heartbeat!")},show:function(e,j,i,l,n){for(var f=0,v=document.body.getElementsByTagName("*"),u;u=v[f];f++)-1!=u.tabIndex&&(r.push([u,u.tabIndex]),u.tabIndex=-1);u=document.querySelectorAll("body > *");for(f=0;v=u[f];f++)if(!("rslightbox_overlay"==v.id||"rslightbox_contentcontainer"==v.id||"script"==v.tagName.toLowerCase())){var A=
v.getAttribute("aria-hidden");A&&v.setAttribute("data-original-aria-hidden",A);v.setAttribute("aria-hidden","true")}e=e||"";i=i||!1;t?(t.style.display="",k.style.display=""):(t=document.createElement("div"),t.id="rslightbox_overlay",k=document.createElement("div"),k.id="rslightbox_contentcontainer",k.innerHTML=rspkr.st.r().replaceTokens(p.join("\n"),{rsLIGHTBOX_CLOSE_LABELrs:rspkr.cfg.getPhrase("close")}),$rs.setAttr(t,"style",b.join(";")),$rs.setAttr(k,"style",g.join(";")),document.body.appendChild(t),
document.body.appendChild(k),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.changed.addButtonEvents,context:rspkr.st.r().handlers.changed,params:[this]}));f=$rs.get("rslightbox_closer");rspkr.ui.addFocusHandler(f,!1);$rs.regEvent(f,"click",function(a){w(a);rspkr.ui.Lightbox.hide(a)});$rs.regEvent(t,"click",rspkr.ui.Lightbox.hide);$rs.regEvent(document.body,"keyup",a);if((f=document.documentElement)&&document.all)f.style.overflowX=f.style.overflowY="hidden";if(e!=x||i)$rs.get("#rslightbox_content").innerHTML=
"",$rs.css("#rslightbox_content","height","auto"),/^http/i.test(e)?$rs.findIn("#rslightbox_content","iframe").length||(i=document.createElement("iframe"),i.src=e,i.className="rslightbox-iframe",void 0===n&&(n=2E3),$rs.get("#rslightbox_content").appendChild(i)):"<"==e.substr(0,1)&&($rs.get("#rslightbox_content").innerHTML=e),$rs.get("#rslightbox_buttons").innerHTML=j,x=e,"ar_ar"==rs.c.data.params.lang&&(-1==k.className.indexOf("rtl")&&(k.className=(k.className+" rtl").replace(/^\s+|\s+$/g,"")),$rs.setAttr($rs.findIn(k,
"legend"),"align","right"));y=void 0!==n&&!isNaN(n)?n:!rspkr.basicMode?$rs.get("#rslightbox_content").clientHeight:$rs.get("#rslightbox_content").scrollHeight;e=$rs.findIn("#rslightbox_content",".rsform-row");for(f=0;f<e.length;f++){j=$rs.findIn(e[f],"input, a, select");$rs.isArray(j)||(j=[j]);for(v=0;v<j.length;v++)rspkr.ui.addFocusHandler(j[v],!1,e[f])}var z=$rs.findIn("#rslightbox_buttons",".rssettings-button-close");rspkr.ui.addFocusHandler(z,!1);$rs.regEvent(z,"click",function(a){w(a)});(e=$rs.findIn("#rsform_wrapper",
".rssettings-button-gotobottom"))&&!$rs.isArray(e)&&rspkr.ui.addFocusHandler(e,!1);(e=$rs.findIn("#rslightbox_buttons",".rssettings-button-gototop"))&&!$rs.isArray(e)&&rspkr.ui.addFocusHandler(e,!1);var h=$rs.findIn("#rslightbox_content","input");$rs.isArray(h)&&0<h.length?setTimeout(function(){rspkr.ui.focus(h[0]);rspkr.Common.addEvent("onFocusIn",function(a){a.className&&$rs.hasClass(a,"rssettings-button-gototop")?rspkr.ui.focus(h[0]):a.className&&$rs.hasClass(a,"rssettings-button-gotobottom")&&
rspkr.ui.focus(z)})},200):$rs.isArray(h)||setTimeout(function(){rspkr.ui.focus(h)},200);c();$rs.regEvent(window,"resize",c);"function"==typeof l&&l.apply(this,[k])},hide:function(b){for(;0<r.length;)b=r.pop(),b[0].tabIndex=b[1];for(var b=document.querySelectorAll("body > *"),g=0,i;i=b[g];g++){var l=i.getAttribute("data-original-aria-hidden");l?(i.setAttribute("aria-hidden",l),i.removeAttribute("data-original-aria-hidden")):i.removeAttribute("aria-hidden")}w(b);t.style.display="none";k.style.display=
"none";$rs.unregEvent(window,"resize",c);$rs.unregEvent($rs.get("#rslightbox_closer"),"click",rspkr.ui.Lightbox.hide);$rs.unregEvent(t,"click",rspkr.ui.Lightbox.hide);$rs.unregEvent(document.body,"keyup",a);if((b=document.documentElement)&&document.all)b.style.overflowX=b.style.overflowY="auto";rspkr.ui.updateFocus();rspkr.c.dispatchEvent("onSettingsClosed",window,[])},reposition:u}}();
